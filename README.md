# Font Recognition using Tensorflow and Facenet


## File structure/files
* This folder holds the application, and should have external folders with the data.

```
fonts_project    
└───datasets
│   └─── New Pangram 2
│   └─── UT research project datasets
│   │   │ Style Sku Family.csv
└───models
└───logs
└───fontnet
```

* I run the code in this repository using anacondas with python 3.7 on Ubuntu 18.03. For tensorflow, version 1.7 or better is required.
`conda install tensorflow`

## Preprocessing 

Run `preprocessing.sh` this should create the necessary cropped data. 

## Training

Run `train.sh`. I trained until the loss function is between .8-.6. Results may vary. It took me about 36 hours on relatively weak hardware i.e. I5-6260U CPU @ 1.80GHz × 4 and 16 GB RAM. 

## Cross-validation


First run `gen_pairs.sh` this should create the necessary data for cross-validation. The `pairs.txt` files will appear in the folder with the testing data. There are 2 sets:
* Easy, this is generated by specifying `diff_style` 0.
* Hard, this is generated by specifying `diff_style` 1. We test to see if the font is trained to recognize families and not just styles.  

Then run `validate.sh` this should display statistics about the model. You will need to specify the model and log directory. This is generated by training a model.


## Saving the embeddings

Run `write_embeddings.sh`.  You will need to specify the model and log directory. This is generated by training a model. The result of this script will appear in the UT research project datasets folder. Without modifying the code, the file will be called `embeddings_full.csv`.